server:
  port: 8080

logging:
  level:
    org.springframework.security: INFO

spring:
  data:
    redis:
      host: localhost
      port: 6379
      database: 0
  datasource:
    url: ${POSTGRES_DB_URL:jdbc:postgresql://localhost:5432/taxrefund}
    username: ${POSTGRES_DB_USERNAME:postgres}
    password: ${POSTGRES_DB_PASSWORD:postgres}
  jpa:
    hibernate:
      ddl-auto: validate
    properties:
      hibernate:
        format_sql: true
  flyway:
    enabled: true

ml:
  baseUrl: http://ml:8000

# health check end points /actuator/health/liveness, /actuator/health/readiness
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      probes:
        enabled: true
  health:
    livenessState:
      enabled: true
    readinessState:
      enabled: true

app:
  ratelimit:
    enabled: true
    refundLatest:
      capacity: 30          # burst tokens
      refillPerMinute: 30   # steady rate
    assistantChat:
      capacity: 10
      refillPerMinute: 10

  security:
    jwt:
      secret: ${APP_SECURITY_JWT_SECRET:change-me-change-me-change-me-change-me-123456}
      issuer: ${APP_SECURITY_JWT_ISSUER:refund-status}
      accessTokenMinutes: 15
      refreshTokenDays: 14
    cookies:
      refreshName: refresh_token
      secure: false # true in prod (https)
      sameSite: Lax

ai:
  provider: ${AI_PROVIDER:mock}   # mock | openai
  openai:
    apiKey: ${OPENAI_API_KEY:}
    model: ${OPENAI_MODEL:gpt-4o-mini}

refund:
  polling:
    enabled: true
    fixedDelayMs: 10000
